<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./header/header.css" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    
<title>Hộp thư - Thông báo</title>
<style>
body {
/* Sử dụng font hệ thống hiện đại */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
        }
.container {
  max-width: 700px;
  margin: 50px auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  padding: 20px;
}
h1 {
  text-align: center;
  color: #333;
}
.notify {
  border-left: 5px solid #ff4444;
  margin: 15px 0;
  padding: 10px 15px;
  border-radius: 8px;
  background: #fff7e6;
}
.notify .from {
  color: red;
  font-weight: bold;
}
.notify .time {
  font-size: 12px;
  color: gray;
  text-align: right;
}
.spacer-200 {
  /* Chiều cao 200 pixels */
  height: 200px; 
  /* Đôi khi dùng "min-height" để đảm bảo khoảng trống không bị mất */
  min-height: 200px;
}
</style>
</head>
<div id="header-container"></div>
<div class="spacer-200"></div>
<body>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-4xl mt-10 mb-10">
        <div class="bg-white rounded-xl shadow-2xl overflow-hidden">
            
            <div class="p-6 bg-blue-600 text-white flex items-center justify-center">
                <i class="fas fa-envelope-open-text text-3xl mr-3"></i>
                <h2 class="text-2xl md:text-3xl font-bold tracking-tight">Hộp thư của bạn</h2>
            </div>
            
            <div id="notifyList" class="p-4 md:p-6">
                <p class="text-center text-gray-500 py-10">Đang tải...</p>
            </div>
            
        </div>
    </div>

<script>
(async () => {
  const token = localStorage.getItem('token');
  const container = document.getElementById('notifyList');

  if (!token) {
    container.innerHTML = '⚠️ Bạn cần đăng nhập để xem hộp thư.';
    return;
  }

  const res = await fetch('https://humoral-antonina-denudative.ngrok-free.dev/api/notifications/me', {
    headers: { 'Authorization': `Bearer ${token}` }
  });

  if (!res.ok) {
    container.innerHTML = '⚠️ Không thể tải thông báo. Vui lòng đăng nhập lại.';
    return;
  }

  const data = await res.json();
  const list = data.notifications || [];

  function escapeHtml(text) {
    const div = document.createElement('div');
    div.innerText = text;
    return div.innerHTML;
  }

  if (list.length === 0) {
    container.innerHTML = 'Chưa có thông báo nào.';
    return;
  }

  container.innerHTML = list.map(n => `
    <div class="notify">
      <div class="from">- [Admin] :</div>
      <div class="msg">${escapeHtml(n.message)}</div>
      <div class="time">${new Date(n.createdAt).toLocaleString()}</div>
    </div>
  `).join('');
})();
</script>
<script src="./header/header.js"></script>
</body>
</html>
